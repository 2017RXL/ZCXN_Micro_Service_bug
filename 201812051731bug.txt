20190103
问题：电池在空闲时，SOC小于0.4，突然变为放电，对于截止电压的修改
1、放电截止电压的修改一定是从放电状态过程转换过来的，因此加了一个条件，
前10分钟不能出现空闲的情况，



20181222

多次出现授权的情况，
1、modbus上锁，但是没有对非授权命令进行上锁，
2、modbus命令执行失败后，重复在执行modbus的命令(3次机会)



20181214 

SOC已经到了放电深度60%，SOC到了40%，对于采用当前电池电压为截止电压。

20181210 修改

修改了充放电学习完成后的，上报的信息，将之前的battery study over 变为batteryStudyOver

20181208 需求
按照王总的要求，加上随机充放电时的，也要进行对于放电截止电压的修改操作。
因为在按照充放电学习得到的放电截止电压，可以放出77%的电量，因为是小功率放电，电流比较小，同一个截止电压可以放出更多的电压，
因此当SOC等于60% 的时候，将采用当前电压是为放电截止电压。避免放出更多的电量。

20181207 问题
在充放电学习过程中，发现了返回的充电效率是-0.9933 ，未考虑是充电量和放电量的正负问题，没有计算充电量累计值，和放电量累计值。
充电效率和累计充放电量没有考虑到充电效率以及负数的情况，增加了充电效率负数转为正数的修改，以及累计充放电量累计逻辑


20181206 问题
当在充电学习过程中：
1、随着负载功率的增加，导致电池在能量调度的充电阶段，状态会有变化，电池会变为空闲或者放电的情况。
2、在光伏发电充足的情况下，在能量调度工作模式下的放电学习中，电池的放电功率会受到影响。正常情况下，能量调度情况下
放电功率是2700w多，但是实际只有900w多。
 
 自我理解： 逆变器的最大逆变功率是5000w ，这时候 一个PV2455 w， 另一个PV的1299 w，逆变器优先 逆变PV的功率，在随后逆变
 电池的功率，所以才导致的电池的最大输出功率是900w -1300w 多
3、在澳洲每天早上5:30-- 6.40 的时间段内电池在充电过程中多次边为空闲、放电状态，
自我猜测 ：①电网不稳定导致的② 科华逆变器没有做好判断电池状态信息

20181205 bug

当在充放电学习过程中，第二个充电阶段，充电过程中，当负载用电量的功率增加时，电池出现了空闲和放电状态。导致SOC的计算出现错误，
由于SOC是根据采集周期（5分钟）的一段时间的最后一条电池状态用来，判断该时间段内SOC的变化。如果是空闲状态是，SOC就不累加，
如果是放电状态SOC
就是递减的。

20181205 bug

在充电过程中SOC递减
原因: 没有对于查询周期内的数据进行排序处理。

在非学习状态未去掉如下代码：
socStatus.IsFull = true
socStatus.IsEmpty = false
导致的开启充放电学习直接进入到放电模式。

将浮充的条件修改为:
在电池学习过程中：
                   电流小于放电截止电流，保持5分钟以上，满足放电截止电压的范围，在充电学习过程中。
在非电池学习过程中： 查询之前在10分钟内，没有进行放电过程。并且soc大于0.95的时候，在浮充电压范围内，既不是学习充电状态，又不是学习放电状态

20181203 bug

在进行第一SOC放电过程中 将放电截止电压修改为45.6V  但是当第二次放电过程中，SOC大于40% 的时候，应到了放电截止电压，卡在
微服务的充放电学习过程中，电池一直处于空闲状态，


解决办法： 
     当发生如上描述情况时，采用修改放电截止电压的方法，继续让电池放电，直到放电到40%，或者40%一下。


20181201 微服务程序中的问题

1、soc的计算是否正确，需要根据每次放电量的 累计值，判断SOC是否正确。
答：
	在进行第二次放电之前， 放电总量为20.57kwh，在进行第二次放电结束时 的放电总量是 31.42, 
	放出的电量为31.42-20.57=10.85，放出电量百分比10.85/19.2=0.56510 ，电池SOC百分比 1-0.56510=0.43489
	soc 的计算是正确的
2、没有进入到浮充条件，就开始第二次的放电过程。
答：   
	当电池充电功率是1181w，电池电压是56.3V， 电流是21A，之后从modbus的回复报文上看，
	电池突然处于空闲状态，电压降到54.4V  保持10s以上时，假装浮充状态，从而进入了放电阶段
	
        充电之前的充电电量是17.73kwh，充电结束的充电量是30.19kwh，充入的电量是：12.46kwh  10.85/12.46=0.87
     
3、当发生第二次的放电截止低于第一次的放电截止电压，逆变器不会再放电，但是微服务要放电，充放电学习无法完成





